---
title: "Exploratory Plots"
author: "Alejandro C. Frery"
date: "2023-10-16"
output: pdf_document

# output: 
#   pdf_document:
#     toc: true
#     toc_depth: 2
#html_document
header-includes:
  - \usepackage{graphicx}
  - \usepackage{float}
  - \usepackage{bm}
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}

---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
#knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

library(reshape2)
#library(plotly)
library(knitr)
library(pandoc)
library(gridExtra)
library(tidyr)
library(gtools)
library(stats4)
library(rmutil)
library(scales)
library(tidyr)
library(gtools)
library(stats4)
library(rmutil)
library(invgamma)
library(tidyverse)
library(scales)
library(RColorBrewer)
library(ggsci)
library(wesanderson)
library(ggpubr)
library(patchwork)
options(kableExtra.latex.load_packages = FALSE)
library(devtools)
devtools::install_github("haozhu233/kableExtra")
#devtools::install_github("haozhu233/kableExtra")
library(kableExtra)
library(ggthemes)
theme_set(theme_bw()  +
            theme(text=element_text(family="serif"),
                  legend.position = "top")# Gridtop , right , bottom , or left#, panel.grid = element_blank()
)
# Helpful for latex tables
# library(xtable)
# options(xtable.caption.placement='top',
#         xtable.table.placement='!t',
#         xtable.include.rownames=F,
#         xtable.comment=F)
# #library(rgl)



source("../MainFunctions/gamma_sar_sample.r")
source("../MainFunctions/entropy_gamma_sar.r")

source("../MainFunctions/van_es_estimator.r")
source("../MainFunctions/correa_estimator.r")
source("../MainFunctions/ebrahimi_estimator.r")
source("../MainFunctions/noughabi_arghami_estimator.r")
source("../MainFunctions/vasicek_estimator.r")
source("../MainFunctions/al_omari_1_estimator.r")
source("../MainFunctions/al_omari_2_estimator.r")

source("../MainFunctions/bootstrap_van_es_estimator.r")
source("../MainFunctions/bootstrap_correa_estimator.r")
source("../MainFunctions/bootstrap_ebrahimi_estimator.r")
source("../MainFunctions/bootstrap_noughabi_arghami_estimator.r")
source("../MainFunctions/bootstrap_vasicek_estimator.r")
source("../MainFunctions/bootstrap_al_omari_1_estimator.r")
source("../MainFunctions/bootstrap_al_omari_2_estimator.r")
#The next function contains the functions: generate_samples, calculate_bias_mse, generate_plot
source("../Programs/functions_sample_bias_mse.R")# 

set.seed(1234567890, kind = "Mersenne-Twister")

```


# Gamma-SAR entropy

We will see how the Shannon entropy of the Gamma-SAR model varies.
It is given by
\begin{align}
H_{\Gamma_{\text{SAR}}}(L_0, \mu) &=   L_0 -\ln(L_0/\mu)+\ln\Gamma(L_0)+(1-L_0)\psi^{(0)}(L_0)\\
&= \big[L_0 -\ln L_0+\ln\Gamma(L_0)+(1-L_0)\psi^{(0)}(L_0)\big] + \ln \mu.
\end{align}
where $L_0\geq 1$ is known, and $\mu>0$ is the mean.
We see that, given $L_0$, the entropy of a random variable following the Gamma-SAR model depends on the logarithm of the mean $\mu$.

```{r FunctionsDefinitions}
entropy_gamma_sar <- function(L, mu) {
  
    return(L - log(L) + log(gamma(L)) + (1 - L) * digamma(L) + log(mu))
  
}

entropy_gI0 <- function(mu, alpha, L) {
  
  term1 <- L - log(L) + log(gamma(L)) + (1 - L) * digamma(L) + log(mu)   
  term2 <- -L - log(gamma(L-alpha)) + (L-alpha)*(digamma(L - alpha))- (1-alpha)*digamma(- alpha)+log(-1 - alpha)+log(gamma(-alpha))
  
  entropy <- term1 + term2 
  return(entropy)
}

gamma_sar_sample <- function(L, mu, n) {
  samples <- rgamma(n, shape = L, rate = L / mu)
  return(samples)
}


```



```{r PlotGammaSAR, echo=FALSE, message=FALSE, warning=FALSE, out.width="80%", fig.show="hold", fig.align="center", fig.pos="hbt", fig.cap="Simulation of entropy for Gamma SAR"}
L <- c(1, 3, 8, 12, 100)


L_labels <- c("L = 1", "L = 3", "L = 8", "L = 12", "L = 100")

mu <- seq(0.1, 10, length.out = 500)


entropies <- sapply(L, function(L) entropy_gamma_sar(L, mu))


muEntropy <- data.frame(mu, entropies)


muEntropy.molten <- melt(muEntropy, id.vars = "mu", variable.name = "Looks", value.name = "Entropy")


ggplot(muEntropy.molten, aes(x = mu, y = Entropy, col = Looks)) +
  geom_line() +
  #theme_minimal() +
  scale_color_manual(values = rainbow(length(L)), labels = L_labels) +
  labs(col = "Looks") +
  xlab(expression(paste(mu)))

```

# GI0-SAR Entropy

The Shannon entropy of the GI0-SAR model is given by

\begin{multline}
\label{E:E-GIO}
H_{\mathcal{G}_I^0}(\mu, \alpha, L_0) =\underbrace{L_0 -\ln L_0+\ln\Gamma(L_0)+(1-L_0)\psi^{(0)}(L_0) +\ln \mu}_{H_{\Gamma_{\text{SAR}}}} 
-\ln\Gamma(L_0-\alpha)+ (L_0-\alpha) \psi^{(0)}(L_0-\alpha)\\
-(1-\alpha)\psi^{(0)}(-\alpha)+\ln (-1-\alpha)+\ln\Gamma(-\alpha)-L_0
\end{multline}


```{r 3d_GIO, fig.align="center",  out.width = "120%", fig.cap="Simulation of entropy for ${G}_I^0$. ", fig.show="hold",  fig.pos="hbt"}
knitr::include_graphics("../../../Figures/PDF/entropy_plot_3d.pdf")
```



