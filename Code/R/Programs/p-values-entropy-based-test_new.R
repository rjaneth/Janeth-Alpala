#rm(list = ls())
#load("../Programs/Data/Phantom_4_z.Rdata")
#save( cd_values_mnad, x, file = "./Data/MnAD_results_data_Rotterdam_1024.Rdata")
#load("../Programs/Data/MnAD_results_data_Rotterdam_1024.Rdata")
#load("../Programs/Data/Phantom_4_regions.Rdata")
#load("./Data/results_Mexico_512_7_AO_300b.Rdata")#
#load("./Data/results_Phantom_4_regions_AO_7W_L5_100b.Rdata")
#load("./Data/results_Chicago_1024_9_AO_200b_36L.Rdata")#OK
#load("./Data/results_Mexico_512_7_AO_300b.Rdata")#OK
#load("./Data/results_panama_512_AO_9W_L5_100b.Rdata")
#save(difference_values, x, file = "./Data/results_Panama_512_AO_7x7_L5_200b.Rdata")
#load("./Data/results_Panama_512_AO_7x7_L5_200b.Rdata")
#load("./Data/results_Lake_512_9W_AO_100b_36L.Rdata")#OK
#load("./Data/results_Phantom_4_z1_200b.Rdata")#OK
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_10.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_B100.Rdata")
#load("./Data/results_Phantom_4_renyi_B100.Rdata")
#save(difference_values, x, file = "./Data/results_rotterdam_renyi_w7_10_07.Rdata")
#load("./Data/results_rotterdam_renyi_w7_10_07.Rdata")
#save(p_values_beta1, Z, file = "./Data/p_values_beta1.Rdata")
#save(p_values_beta1, Z, file = "./Data/p_values_beta1_v1.Rdata")
#load("./Data/p_values_beta1_v1.Rdata")
#save(difference_values, x, file = "./Data/results_rotterdam_renyi_w7_b200_0_65.Rdata")
#load("./Data/results_rotterdam_renyi_w7_b200_0_65.Rdata")
#load("./Data/results_Rotterdam_AO_L1_7_2.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_B100_w7_075_L5.Rdata")#Ok but w9
#load("./Data/results_Phantom_4_renyi_B100_w7_075_L5.Rdata")
#save(difference_values, x, file = "./Data/results_panama_512_renyi_w7_b100_075_L5_w9.Rdata")
#load("./Data/results_panama_512_renyi_w7_b100_075_L5_w9.Rdata")
#save(difference_values, x, file = "./Data/results_illinois_1024_renyi_b100_085_L36_w9.Rdata")
#load("./Data/results_illinois_1024_renyi_b100_085_L36_w9.Rdata")
#save(difference_values, x, file = "./Data/results_sanFrancisco_650_renyi_b200_075_L5_w11.Rdata")
#load("./Data/results_sanFrancisco_650_renyi_b200_075_L5_w11.Rdata")
#save(difference_values, x, file = "./Data/results_illinois_1024_renyi_b200_075_L36_w11.Rdata")
#load("./Data/results_illinois_1024_renyi_b200_075_L36_w11.Rdata")
#save(difference_values, x, file = "./Data/results_illinois_1024_renyi_b200_09_L36_w7.Rdata")
#load("./Data/results_illinois_1024_renyi_b200_09_L36_w7.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_B200_w9_08_L5.Rdata") #OK
#load("./Data/results_Phantom_4_renyi_B200_w9_08_L5.Rdata")
#save(difference_values, x, file = "./Data/results_illinois1_512_renyi_b200_08_L36_w9.Rdata")
#load("./Data/results_illinois1_512_renyi_b200_08_L36_w9.Rdata")
#save(difference_values, x, file = "./Data/results_illinois1_512_renyi_b100_08_L36_w11.Rdata")
#load("./Data/results_illinois1_512_renyi_b100_08_L36_w11.Rdata")
#save(difference_values, x, file = "./Data/results_spain_2500_renyi_b100_08_L5_w9.Rdata")
#load("./Data/results_spain_2500_renyi_b100_08_L5_w9.Rdata")
#save(difference_values, x, file = "./Data/results_sinaloa_512_renyi_b100_085_L18_w9.Rdata")
#load("./Data/results_sinaloa_512_renyi_b100_085_L18_w9.Rdata")
#save(difference_values, x, file = "./Data/results_sinaloa_512_renyi_b100_09_L18_w7.Rdata")
#load("./Data/results_sinaloa_512_renyi_b100_09_L18_w7.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_B100_w7_085_L5.Rdata")
#load("./Data/results_Phantom_4_renyi_B100_w7_085_L5.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_B100_w7_09_L5.Rdata")
#load("./Data/results_Phantom_4_renyi_B100_w7_09_L5.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_AO_B100_w7_L5.Rdata")
#load("./Data/results_Phantom_4_AO_B100_w7_L5.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_AO_B100_w9_L5.Rdata")
#load("./Data/results_Phantom_4_AO_B100_w9_L5.Rdata")
#save(difference_values, x, file = "./Data/results_SanFrancisco_650_renyi_b1_099_L1_w9.Rdata")
#load("./Data/results_SanFrancisco_650_renyi_b1_099_L1_w9.Rdata")
#save(difference_values, x, file = "./Data/results_SanFranciscoN_600_renyi_b1_099_L1_w9.Rdata")
#load("./Data/results_Amazonas_700_renyi_b100_085_L18_w7.Rdata")#results_Phantom_4_renyi_B200_w7_085_L5.Rdata
#load("./Data/results_Phantom_4_renyi_B200_w7_085_L5.Rdata")
#save(difference_values, x, file = "./Data/results_Rotterdam_1024_renyi_b50_07_L1_w7.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_B200_w7_09_L5.Rdata")
load("./Data/results_rotterdam_renyi_w7_2_0_07.Rdata")
#save(difference_values, Z, file = "./Data/results_Phantom_4_renyi_w7_1_6_L5.Rdata")
#save(difference_values, x, file = "./Data/results_mexico_renyi_512_w7_L18_b200_090.Rdata")
#load("./Data/results_mexico_renyi_512_w7_L18_b200_090.Rdata")
#load("./Data/results_Phantom_4_AO_B100_w7_L5.Rdata")
#load("./Data/results_Phantom_4_renyi_B200_w7_09_L5.Rdata")
#save(difference_values, x, file = "./Data/results_Illinois_2_renyi_1024_w7_L36_b200_090.Rdata")
#load("./Data/results_Illinois_2_renyi_1024_w7_L36_b200_090.Rdata")
#load("./Data/results_Illinois_2_renyi_1024_w7_b100_L36_098.Rdata")
#load("./Data/results_Illinois_2_renyi_1024_w7_L36_4_0.Rdata")
calculate_p_values_matrix <- function(data_matrix, mu, sigma) {
  rows <- nrow(data_matrix)
  cols <- ncol(data_matrix)
  
  p_values_matrix <- matrix(NA, nrow = rows, ncol = cols)
  
  for (i in 1:rows) {
    for (j in 1:cols) {
      test_difference <- data_matrix[i, j]
      
      epsilon <-(test_difference - 0) / (sigma)
      p_value <-  2*pnorm(-abs(epsilon))# 
      
      p_values_matrix[i, j] <- p_value
    }
  }
  
  return(p_values_matrix )
}




mean_difference_values <- mean(difference_values, na.rm = TRUE)
sd_difference_values <- sd(difference_values, na.rm = TRUE)


p_values_shannon <- calculate_p_values_matrix(difference_values, mean_difference_values, sd_difference_values)
#save(p_values_renyi, file = "./Data/p_values_renyi_4z_renyi_B200_w7_09_L5.Rdata")
#save(p_values_matrix, file = "./Data/results_pvalue_Phantom_4_regions_AO_7W_L5_100b.Rdata")
#save(p_values_shannon, file = "./Data/p_values_shannon_4z_renyi_B200_w7_09_L5.Rdata")
#load("./Data/binary_map_shannon.Rdata")
# save(p_values_nlsLM, x, file = "./Data/p_values_nlsLM_subsample_4z_7w.Rdata")
load("./Data/p_values_nlsLM_subsample_4z.Rdata")

source("../imagematrix.R")
#hist(p_values_matrix)
#plot(imagematrix(p_values_matrix),significance_level = 0.05)
plot(imagematrix(p_values_nlsLM))
plot(imagematrix(p_values_nlsLM> 0.05))
 # plot(imagematrix(equalize(difference_values)))
#plot(imagematrix(equalize(x)))

# 
# #     imagematrixPNG(imagematrix(equalize(x)), name = "sinaloa_512.png")
         imagematrixPNG(imagematrix(equalize(difference_values)), name = "results_rotterdam_renyi_w7_2_0_07.png")
# # # # # # # # # # # 
      imagematrixPNG(imagematrix(p_values_nlsLM), name="H_pvalue_results_nlsLM_subsample_4z_11w.png")
     imagematrixPNG(imagematrix(p_values_nlsLM>0.05), name="H_005_nlsLM_subsample_4z_11w.png")
